<%- include('../partials/head');%>

  <body>
    <div class="wrapper">
      <!-- Header start -->
      <%- include('../partials/header.ejs'); %>
      <!-- Header end -->
      <%- include('../partials/leftbar');%>
        <div class="content-wrapper">
            <!-- main content start -->
            <main class="container-fluid py-3 ps-lg-3 pe-lg-4 px-3">
              <div class="row g-0 justify-content-center">
                <div class="col-xxl-10 col-xl-11">
                  <div class="card border-0 shadow rounded-5">
                    <div class="card-body p-xl-6 p-md-5 p-4">
                      <h1 class="h2 mb-lg-4 mb-3 pb-xl-2">Add Contact</h1>
                      <% if (message.length> 0) { %>
                        <div class="alert alert-danger">
                          <%= message %>
                        </div>
                        <%}%>
                          <form id="frm" class="row" action="/admin/edit-contact?id=<%= result.id%>" method="post">
                            <div class="col-lg-6">
                              <div class="mb-3 mb-xl-4 pb-md-2">
                                <label for="first_name" class="form-label">First Name*</label>
                                <input type="hidden" name="id" value="<%=result.id%>" />
                                <input type="text" class="form-control form-control-lg" name="first_name"
                                  placeholder="First Name" value="<%= result.first_name%>" required />
                              </div>
                            </div>
                            <div class="col-lg-6">
                              <div class="mb-3 mb-xl-4 pb-md-2">
                                <label for="last_name" class="form-label">Last Name*</label>
                                <input type="text" class="form-control form-control-lg" name="last_name"
                                  placeholder="Last Name" value="<%= result.last_name%>" required />
                              </div>
                            </div>
                            <div class="col-lg-6">
                              <div class="mb-3 mb-xl-4 pb-md-2">
                                <label for="email" class="form-label">Email*</label>
                                <input type="email" class="form-control form-control-lg" name="email" required
                                  placeholder="Email" value="<%= result.email%>" />
                              </div>
                            </div>

                            <div class="col-lg-6">
                              <div class="mb-3 mb-xl-4 pb-md-2 contactform">
                                <label for="phone" class="form-label">Phone Number*</label>
                                <br />
                                <input id="phone" name="phone_number" class="form-control form-control-lg"
                                  placeholder="Phone Number" value="<%= result.phone_number%>" name=”phone” type='tel'>
                              </div>
                              <input type="hidden" name="countryCode" id="countryCode" />
                            </div>


                            <div class="col-lg-6">
                              <div class="mb-3 mb-xl-4 pb-md-2">
                                <label for="address" class="form-label">Address*</label>
                                <textarea id="address" name="address" type="text" class="form-control form-control-lg"
                                  placeholder="Address" required></textarea>
                              </div>
                              <div class="mb-3 mb-xl-4 pb-md-2">
                                <label for="state" class="form-label">State</label>
                                <select id="state" name="state"
                                  class="form-select form-control form-control-lg selectState">
                                  <option selected>-Select-</option>
                                  <option value="AL">Alabama</option>
                                  <option value="AK">Alaska</option>
                                  <option value="AZ">Arizona</option>
                                  <option value="AR">Arkansas</option>
                                  <option value="CA">California</option>
                                  <option value="CO">Colorado</option>
                                  <option value="CT">Connecticut</option>
                                  <option value="DE">Delaware</option>
                                  <option value="DC">District Of Columbia</option>
                                  <option value="FL">Florida</option>
                                  <option value="GA">Georgia</option>
                                  <option value="HI">Hawaii</option>
                                  <option value="ID">Idaho</option>
                                  <option value="IL">Illinois</option>
                                  <option value="IN">Indiana</option>
                                  <option value="IA">Iowa</option>
                                  <option value="KS">Kansas</option>
                                  <option value="KY">Kentucky</option>
                                  <option value="LA">Louisiana</option>
                                  <option value="ME">Maine</option>
                                  <option value="MD">Maryland</option>
                                  <option value="MA">Massachusetts</option>
                                  <option value="MI">Michigan</option>
                                  <option value="MN">Minnesota</option>
                                  <option value="MS">Mississippi</option>
                                  <option value="MO">Missouri</option>
                                  <option value="MT">Montana</option>
                                  <option value="NE">Nebraska</option>
                                  <option value="NV">Nevada</option>
                                  <option value="NH">New Hampshire</option>
                                  <option value="NJ">New Jersey</option>
                                  <option value="NM">New Mexico</option>
                                  <option value="NY">New York</option>
                                  <option value="NC">North Carolina</option>
                                  <option value="ND">North Dakota</option>
                                  <option value="OH">Ohio</option>
                                  <option value="OK">Oklahoma</option>
                                  <option value="OR">Oregon</option>
                                  <option value="PA">Pennsylvania</option>
                                  <option value="RI">Rhode Island</option>
                                  <option value="SC">South Carolina</option>
                                  <option value="SD">South Dakota</option>
                                  <option value="TN">Tennessee</option>
                                  <option value="TX">Texas</option>
                                  <option value="UT">Utah</option>
                                  <option value="VT">Vermont</option>
                                  <option value="VA">Virginia</option>
                                  <option value="WA">Washington</option>
                                  <option value="WV">West Virginia</option>
                                  <option value="WI">Wisconsin</option>
                                  <option value="WY">Wyoming</option>
                                </select>
                              </div>

                              <input type="hidden" id="mutiState" name="mutiState"
                                class="form-control form-control-lg getallarraycontent">
                              <div class="mb-3 mb-xl-4 pb-md-2 selectContentData">
                              </div>
                            </div>

                            <div class="col-lg-12 text-sm-end">
                              <ul class="list-inline mb-0 mt-lg-4 mt-3 pt-xl-2">
                                <li class="list-inline-item me-xl-3">
                                  <a href="/admin/contacts">
                                    <button type="button" class="btn btn-lg btn-outline-danger btn-small"
                                      data-bs-dismiss="modal" aria-label="Close">
                                      Cancel
                                    </button></a>
                                </li>
                                <li class="list-inline-item">
                                  <button type="submit" class="btn btn-lg btn-primary btn-small">
                                    Update
                                  </button>
                                </li>
                              </ul>
                            </div>
                          </form>
                    </div>
                  </div>
                </div>
              </div>
            </main>
            <!-- main content end -->
        </div>
    </div>

    <script type="text/javascript" src="/js/jquery.validate.js"></script>
    <script type="text/javascript">
      function goBack() {
        location.href = "/admin/contact";
        return false;
      }

      $(document).ready(function () {
        $("#frm").validate();
      });

      function submitlogin() {
        jQuery("#frm").submit();
      }

    
   </script>
    <script>
      var input = $("#phone");
      geoIpLookup = function (callback) {
        $.get('https://ipinfo.io', function () {
        }, "jsonp").always(function (resp) {
          var countryCode = (resp && resp.country) ? resp.country : "";
          callback(countryCode);
        });
      },
        geoIpLookup((countryCode) => {
          input.intlTelInput({ initialCountry: countryCode.toLowerCase(), separateDialCode: true });
        })
      input.on("countrychange", function () {
        console.log('dialCode ', input.intlTelInput("getSelectedCountryData").dialCode)
        console.log('countryCode ', input.intlTelInput("getSelectedCountryData").iso2)
        console.log('phoneNumber ', input.val())
        var fullContact = "+" + input.intlTelInput("getSelectedCountryData").dialCode + " " + input.val();
      });
      const phoneNo = () => {
        input.intlTelInput("setCountry", "gb");
        input.intlTelInput("setNumber", "+447986129475");
      }


      // Onload Set Country Code
      if (document.querySelectorAll('#phone').length > 0) {
        document.querySelector('#phone').addEventListener('focus', () => {
          var code = document.querySelector('.selected-dial-code').textContent;
          var inputcode = document.querySelector('#phone').value;
          document.querySelector('#countryCode').value = code + ' ' + inputcode;
        })

        document.querySelector('#phone').addEventListener('keyup', () => {
          var code = document.querySelector('.selected-dial-code').textContent;
          var inputcode = document.querySelector('#phone').value;
          document.querySelector('#countryCode').value = code + ' ' + inputcode;
        })
      }

    </script>
    <%- include('../partials/footer.ejs'); %>
  </body>
  </html>